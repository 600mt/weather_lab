<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>windwindwind</title>
    <style>
        body {
            height: 100vh;
            display: flex;
            color: white;
            background-color: transparent;
            font-family: Arial, sans-serif;
        }

        #info-panel {
            position: absolute;
            width: 30vw;
            padding-left: 20px;
            padding-bottom: 0px;
            background: transparent;
            font-family: 'Times New Roman', Times, serif;
            font-size: 14px;
            font-weight: 300;
            line-height: 1.4;
            overflow-y: auto; 
            max-height: 100vh;
            opacity: 100%;
            scrollbar-width: none;
            color: rgb(167, 49, 221);
            justify-content: center;
        }

        #wind-speed, #wind-gusts, #wind-direction, #temperature {
            font-size: 20px;
            font-family: 'Times New Roman', Times, serif;
        }

        /* Create the vertical dashed line */
        .vertical-line {
            position: absolute;
            height: calc(100% - 400px); /* 40px margin on top and bottom */
            width: 5px;
            left: 50%;
            top: 200px;
            border-left: 2px solid rgb(167, 49, 221); /* Dotted border */
            /* background-color: rgb(167, 49, 221); Add color to the vertical line */
            z-index: 0;
            transition: transform 1s ease;
}


        .stable-line-1 {
            position: absolute;
            width: calc(100% - 40px); /* 40px margin on both sides */
            height: 1px;
            top: 50%;
            left: 20px;
            border-top: 2px dotted rgb(167, 49, 221); /* Dotted border */
            /* background-color: rgb(167, 49, 221); Add color to the horizontal line */
            z-index: 0;
        }

        .stable-line-2 {
            position: absolute;
            height: calc(100% - 40px); /* 40px margin on top and bottom */
            width: 1px;
            left: 50%;
            top: 20px;
            border-left: 2px dotted rgb(167, 49, 221); /* Dotted border */
            /* background-color: rgb(167, 49, 221); Add color to the vertical line */
            z-index: 0;
        }

        @media (max-width: 768px) {
            #info-panel {
                position: absolute;
                width: 85vw;
                justify-content: left;
                background: transparent;
                font-family:'Times New Roman', Times, serif;
                font-size: 14px;
                font-weight: 300;
                line-height: 1.3;
                overflow-y: auto;
                max-height: 100vh;
                opacity: 100%;
                scrollbar-width: none;
                color: rgb(167, 49, 221);
            }
        }

        @media (max-width: 480px) {
            #lines {
                width: 70vw;
            }
        }
    </style>
</head>
<body>
    <div id="info-panel">
        <p id="text"></p>
        <p id="other">
            The wind direction and speed data around Rotterdam, as measured at a height of 10 meters, 
            is most likely collected from several weather stations within the city's proximity. 
            The exact stations can vary depending on the data provider (such as Open-Meteo, 
            KNMI, or other networks).
        </p>
    </div>
    <div id="lines"> <!-- Change <container> to <div> -->
        <div class="vertical-line"></div>
        <div class="stable-line-1"></div>
        <div class="stable-line-2"></div>
    </div>

    <script>
        const apiUrl = 'https://api.open-meteo.com/v1/forecast?latitude=51.9225&longitude=4.4792&current=wind_speed_10m,wind_direction_10m&hourly=temperature_2m&timezone=Europe%2FBerlin';

        let previousWindDirection = null; // Store previous wind direction

        fetch(apiUrl)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                const windSpeed = data.current.wind_speed_10m;
                const windDirection = data.current.wind_direction_10m;
                const windDirectionText = convertWindDirection(windDirection);

                document.getElementById("text").textContent = `Wind direction has been calculated from U/V wind component vectors. At the moment... ${windSpeed} m/s from ${windDirectionText}`;

                adjustBorderLeft(windSpeed);
                rotateLine(windDirection);
            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
            });

        function convertWindDirection(degrees) {
            if (degrees >= 0 && degrees < 22.5) return "North (N)";
            if (degrees >= 22.5 && degrees < 67.5) return "North-East (NE)";
            if (degrees >= 67.5 && degrees < 112.5) return "East (E)";
            if (degrees >= 112.5 && degrees < 157.5) return "South-East (SE)";
            if (degrees >= 157.5 && degrees < 202.5) return "South (S)";
            if (degrees >= 202.5 && degrees < 247.5) return "South-West (SW)";
            if (degrees >= 247.5 && degrees < 292.5) return "West (W)";
            if (degrees >= 292.5 && degrees < 337.5) return "North-West (NW)";
            return "North (N)";
        }

        function adjustBorderLeft(windSpeed) {
            const line = document.querySelector('.vertical-line');
            const borderThickness = Math.min(windSpeed, 3); // Limiting the thickness to a max of 3px
            line.style.width = `${borderThickness}px`;
        }

        function rotateLine(degrees) {
            const line = document.querySelector('.vertical-line');
            line.style.transform = `rotate(${degrees}deg)`;
        }
    </script>
</body>
</html>
