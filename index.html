<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>windwindwind</title>
    <style>
        /* Your existing styles remain unchanged */
        body {
            height: 100vh;
            display: flex;
            color: white;
            background-color:rgb(184, 188, 204) 0.5;
            font-family: Arial, sans-serif;
        }
        #text {
            font-family: 'Times New Roman', Times, serif;
            font-size: 1.2em;
            transition: transform 1s ease;
        }
        #info-panel {
            position: absolute;
            width: 40vw;
            padding-left: 20px;
            background: transparent;
            font-size: 14px;
            font-weight: 300;
            line-height: 1.4;
            overflow-y: auto;
            max-height: 100vh;
            color: rgb(34, 58, 165);
            filter: blur(0.5px);
            transition: 3s ease-in-out;
        }
        #info-panel:hover {
            filter: blur(0px);
            transition: 1s ease-in-out;
        }
        .vertical-line {
            position: absolute;
            height: calc(100% - 400px);
            width: 3px;
            left: 50%;
            top: 200px;
            border-left: solid rgb(34, 58, 165);
            transition: transform 1s ease;
            filter: blur(1px);
        }
        .stable-line-1 {
            position: absolute;
            width: calc(100% - 40px);
            height: 1px;
            top: 50%;
            left: 20px;
            border-top: 2px dotted rgb(34, 58, 165);
            filter: blur(0.5px);
        }
        .stable-line-2 {
            position: absolute;
            height: calc(100% - 40px);
            width: 1px;
            left: 50%;
            top: 20px;
            border-left: 2px dotted rgb(34, 58, 165);
            filter: blur(0.5px);
        }

        @media (max-width: 768px) {
            #info-panel {
                position: absolute;
                width: 85vw;
                justify-content: center;
                background: transparent;
                font-family:'Times New Roman', Times, serif;
                font-size: 14px;
                font-weight: 300;
                line-height: 1.3;
                overflow-y: auto;
                max-height: 100vh;
                opacity: 100%;
                scrollbar-width: none;
                color: rgb(34, 58, 165);
                filter: blur(0.5px);
            }
        }
    </style>
</head>
<body>
    <div id="info-panel">
        <p id="text"> </p>
    </div>
    <div id="lines">
        <div class="vertical-line"></div>
        <div class="stable-line-1"></div>
        <div class="stable-line-2"></div>
    </div>
    <script>
        // Get user's geolocation
        function getWeatherBasedOnLocation() {
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;
                        fetchWeatherData(latitude, longitude);
                    },
                    (error) => {
                        console.error("Error fetching geolocation:", error);
                        document.getElementById("text").innerHTML = 
                            "Unable to retrieve location. Please allow location access.";
                    }
                );
            } else {
                document.getElementById("text").innerHTML = 
                    "Geolocation is not supported by this browser.";
            }
        }

        function fetchWeatherData(latitude, longitude) {
            const apiUrl = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=wind_speed_10m,wind_direction_10m&hourly=temperature_2m&timezone=auto`;
            
            fetch(apiUrl)
                .then((response) => {
                    if (!response.ok) {
                        throw new Error("Network response was not ok");
                    }
                    return response.json();
                })
                .then((data) => {
                    const windSpeed = data.current.wind_speed_10m;
                    const windDirection = data.current.wind_direction_10m;
                    const windDirectionText = convertWindDirection(windDirection);

                    document.getElementById("text").innerHTML = `Here and now, <span style="text-decoration: underline;">the wind is blowing ${windSpeed} m/s from ${windDirectionText}.</span>`;
                    
                    adjustBorderLeft(windSpeed);
                    rotateLine(windDirection);
                })
                .catch((error) => {
                    console.error("There was a problem with the fetch operation:", error);
                });
        }

        function convertWindDirection(degrees) {
            if (degrees >= 0 && degrees < 22.5) return "North (N)";
            if (degrees >= 22.5 && degrees < 67.5) return "North-East (NE)";
            if (degrees >= 67.5 && degrees < 112.5) return "East (E)";
            if (degrees >= 112.5 && degrees < 157.5) return "South-East (SE)";
            if (degrees >= 157.5 && degrees < 202.5) return "South (S)";
            if (degrees >= 202.5 && degrees < 247.5) return "South-West (SW)";
            if (degrees >= 247.5 && degrees < 292.5) return "West (W)";
            if (degrees >= 292.5 && degrees < 337.5) return "North-West (NW)";
            return "North (N)";
        }

        function adjustBorderLeft(windSpeed) {
            const line = document.querySelector(".vertical-line");
            const borderThickness = Math.min(windSpeed, 1);
            line.style.width = `${borderThickness}px`;
        }

        function rotateLine(degrees) {
            const line = document.querySelector(".vertical-line");
            line.style.transform = `rotate(${degrees}deg)`;
        }

        // Fetch weather based on current location on page load
        getWeatherBasedOnLocation();
    </script>
</body>
</html>
